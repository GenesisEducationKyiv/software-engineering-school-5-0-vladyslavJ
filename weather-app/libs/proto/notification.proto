syntax = "proto3";

package notification;

service NotificationService {
  rpc SendNotification (Notification) returns (SendNotificationResponse);
}

message Notification {
  string email = 1;
  EmailType type = 2;
  oneof data {
    SubscriptionConfirmationData subscription_confirmation = 3;
    ConfirmedSubscriptionData confirmed_subscription = 4;
    UnsubscriptionGoodbyeData unsubscription_goodbye = 5;
    DigestData digest = 6;
  }
}

enum EmailType {
  SUBSCRIPTION_CONFIRMATION = 0;
  CONFIRMED_SUBSCRIPTION = 1;
  UNSUBSCRIPTION_GOODBYE = 2;
  DAILY_DIGEST = 3;
  HOURLY_DIGEST = 4;
}

message SubscriptionConfirmationData {
  string confirmationToken = 1;
}

message ConfirmedSubscriptionData {
  string city = 1;
  string frequency = 2; // або enum, якщо треба
  string unsubscribeToken = 3;
}

message UnsubscriptionGoodbyeData {
  string city = 1;
}

message DigestData {
  string city = 1;
  string date = 2;
  Weather weather = 3;
  string unsubscribeToken = 4;
}

message Weather {
  double temperature = 1;
  double humidity = 2;
  string description = 3;
}

message SendNotificationResponse {
  bool success = 1;
  string error_message = 2;
}